<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HANN - ADMIN DASHBOARD</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #050505; color: white; padding: 20px; }
        .card { background: #111; border: 1px solid #333; padding: 20px; border-radius: 15px; margin-bottom: 20px; max-width: 600px; margin-inline: auto; }
        h2 { color: #0ea5e9; font-size: 18px; border-bottom: 1px solid #333; padding-bottom: 10px; margin-top: 0; }
        label { display: block; font-size: 12px; color: #666; margin-bottom: 5px; margin-top: 10px; }
        input, select { width: 100%; padding: 12px; background: #000; border: 1px solid #333; border-radius: 8px; color: white; margin-bottom: 10px; box-sizing: border-box; outline: none; }
        input:focus { border-color: #0ea5e9; }
        .btn { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-blue { background: #0ea5e9; color: white; }
        .btn-blue:hover { background: #0284c7; }
        .btn-red { background: #ff4757; color: white; padding: 5px 10px; font-size: 11px; width: auto; border-radius: 5px; }
        .item { display: flex; justify-content: space-between; align-items: center; background: #1a1a1a; padding: 12px; margin-bottom: 8px; border-radius: 8px; border: 1px solid #333; }
        .btn-group { display: flex; gap: 5px; }
    </style>
</head>
<body>

    <div style="text-align:center; margin-bottom: 30px;">
        <h1 style="letter-spacing: 2px;">MANAGER DASHBOARD</h1>
        <p style="color:#666; font-size: 12px;">Update konten tanpa edit kode HTML</p>
    </div>

    <div class="card">
        <h2>ðŸ“‚ 1. Kelola Kategori</h2>
        <label>Nama Kategori Baru</label>
        <input type="text" id="cat-name" placeholder="Contoh: KONTAK / SOSIAL MEDIA">
        <button class="btn btn-blue" onclick="window.addCategory()">Tambah Kategori</button>
        
        <div id="cat-list" style="margin-top:20px;">
            </div>
    </div>

    <div class="card">
        <h2>ðŸ”˜ 2. Tambah Tombol</h2>
        <label>Pilih Kategori</label>
        <select id="select-cat">
            <option value="">-- Pilih Kategori --</option>
        </select>

        <label>Icon / Emoji</label>
        <input type="text" id="btn-icon" placeholder="Contoh: ðŸ’¬ atau https://link-foto.com/icon.png">

        <label>Nama Tombol</label>
        <input type="text" id="btn-label" placeholder="Contoh: WhatsApp Utama">

        <label>Link Tujuan</label>
        <input type="text" id="btn-link" placeholder="Contoh: https://wa.me/...">

        <button class="btn btn-blue" onclick="window.addButton()">Simpan Tombol ke Dashboard</button>
    </div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, onValue, push, remove, set } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    // PAKAI CONFIG BARU LU
    const firebaseConfig = {
        apiKey: "AIzaSyBgqJ0f2v88T6Ijamd5gGS-NZzJyVl0pYU",
        authDomain: "adminhann25.firebaseapp.com",
        projectId: "adminhann25",
        databaseURL: "https://adminhann25-default-rtdb.asia-southeast1.firebasedatabase.app", // Sesuaikan URL DB lu
        storageBucket: "adminhann25.firebasestorage.app",
        messagingSenderId: "1020946488981",
        appId: "1:1020946488981:web:9b2cf0902f5665e342c59c"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // --- FUNGSI KATEGORI ---
    window.addCategory = () => {
        const name = document.getElementById('cat-name').value.trim();
        if(!name) return Swal.fire("Error", "Nama kategori jangan kosong!", "error");
        
        push(ref(db, 'dashboard/categories'), { name: name.toUpperCase() })
        .then(() => {
            document.getElementById('cat-name').value = "";
            Swal.fire("Sip!", "Kategori berhasil dibuat", "success");
        });
    };

    onValue(ref(db, 'dashboard/categories'), (snap) => {
        const list = document.getElementById('cat-list');
        const select = document.getElementById('select-cat');
        list.innerHTML = "";
        select.innerHTML = '<option value="">-- Pilih Kategori --</option>';
        
        if(snap.exists()){
            snap.forEach(child => {
                const data = child.val();
                // Tampilkan di list kelola
                list.innerHTML += `
                    <div class="item">
                        <span><b>${data.name}</b></span>
                        <button class="btn-red" onclick="window.delData('dashboard/categories/${child.key}')">Hapus</button>
                    </div>`;
                // Masukkan ke dropdown pilihan kategori
                select.innerHTML += `<option value="${child.key}">${data.name}</option>`;
            });
        }
    });

    // --- FUNGSI TOMBOL ---
    window.addButton = () => {
        const catId = document.getElementById('select-cat').value;
        const icon = document.getElementById('btn-icon').value.trim();
        const label = document.getElementById('btn-label').value.trim();
        const link = document.getElementById('btn-link').value.trim();
        
        if(!catId || !label || !link) return Swal.fire("Waduh", "Kategori, Nama, dan Link harus diisi!", "warning");
        
        push(ref(db, `dashboard/categories/${catId}/buttons`), { 
            icon: icon || 'ðŸ”—', 
            label, 
            link,
            ts: Date.now() 
        })
        .then(() => {
            document.getElementById('btn-icon').value = "";
            document.getElementById('btn-label').value = "";
            document.getElementById('btn-link').value = "";
            Swal.fire("Berhasil!", "Tombol sudah masuk ke Dashboard", "success");
        });
    };

    window.delData = (path) => {
        Swal.fire({
            title: "Yakin dihapus?",
            text: "Data ini bakal hilang dari Dashboard!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#ff4757",
            confirmButtonText: "Ya, Hapus!"
        }).then((result) => {
            if (result.isConfirmed) remove(ref(db, path));
        });
    };
</script>
</body>
</html>

